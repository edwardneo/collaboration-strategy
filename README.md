this code came to me in a dream, and so did I
