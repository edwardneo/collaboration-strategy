Derived from Berkeley's CS 285 homeworks